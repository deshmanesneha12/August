package demo;

import java.io.File;
import java.io.FileInputStream;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;

import org.apache.poi.ss.usermodel.CellType;
import org.apache.poi.ss.usermodel.Cell;
import org.apache.poi.ss.usermodel.Row;
import org.apache.poi.xssf.usermodel.XSSFCell;
import org.apache.poi.xssf.usermodel.XSSFRow;
import org.apache.poi.xssf.usermodel.XSSFSheet;
import org.apache.poi.xssf.usermodel.XSSFWorkbook;

public class ReadWriteExcel {

	public static void writeToExcel(File f) throws IOException {

		FileOutputStream fos = new FileOutputStream(f);// fileoutstream

		XSSFWorkbook wkbk = new XSSFWorkbook();// create workbook
		XSSFSheet sheet = wkbk.createSheet();// create sheet
		for (int i = 0; i < 3; i++) {
			XSSFRow row = sheet.createRow(i);// create row
			for (int j = 0; j < 3; j++) {
				XSSFCell cell = row.createCell(j);// create cell
				cell.setCellValue("user" + i + j);
			}
		}
		wkbk.write(fos);
		// wkbk.close();
		fos.close();

	}

	public static void readExcel(File f) throws IOException {

		FileInputStream fis = new FileInputStream(f);// fileinputstream

		XSSFWorkbook wkbk = new XSSFWorkbook(fis);// create workbook
		XSSFSheet sheet = wkbk.getSheet("data");
		for (Row row : sheet) {

			for (Cell cell : row) {
				System.out.println(cell.getStringCellValue());
			}
		}
		fis.close();
		// wkbk.close();

	}

//	public static Object getCellValue(Cell c) {
//
//		CellType type = c.getCellType();
//		switch (type) {
//		case BOOLEAN:
//			return c.getBooleanCellValue();
//		//case Blank:
//			return c.getNumericCellValue();
//		//case string:
//			return c.getRichStringCellValue();
//		}
//
//	}

	public static void main(String[] args) throws IOException {

		File f = new File("C:\\Users\\Sneha\\Work\\Automation\\Test.xlsx");
		writeToExcel(f);
		readExcel(f);
	}

}
